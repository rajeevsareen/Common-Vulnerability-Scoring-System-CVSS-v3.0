#include<stdio.h>
#include<math.h>


//Global variables
float Environmental_score;

//prototype declaration

void Environment(float AV,float AC,float PR,float UI,float CI,float II,float AI,int scope,float CR,float IR,float AR,float EC,float RL,float RC);


main(){

int attackvector;
float  Network;
float Adjacent;
float Local;
float Physical;
float choose1;	
	printf("Choose Attack Vector(AV): \n");
	printf("1.Network(N)\n");
	printf("2.Adjacent Network(A)\n");
	printf("3.Local(L)\n");
	printf("4.Physical(P) \n");
	scanf("%d",&attackvector);
	
	
switch(attackvector)
	{
	
	
	case 1:
	
		Network=0.85;
		choose1=Network;
	break;
	
	case 2:
	
		Adjacent=0.62;
		choose1=Adjacent;
	break;
	
	case 3:
	
		Local= 0.55;
		choose1=Local;
	break;
	
	case 4:
		
		Physical=0.2;
		choose1=Physical;
	break;
	
		
		
		
	}
	
										system("cls");
int attackcomplexity;
float ACLow;
float ACHigh;
float choose2;
	printf("Choose Attack Complexity(AC): \n");
	printf("1.Low(L) \n");
	printf("2.High(H) \n");
	scanf("%d",&attackcomplexity);
	
switch(attackcomplexity)
{

	case 1:
		ACLow=0.77;
		choose2=ACLow;
	break;
	
	case 2:
		ACHigh=0.44;
		choose2=ACHigh;
	break;
	
	default: 
		printf("Invalid Value");
	
}
								system("cls");
int privillegerequired,scope;
			printf("Choose Scope(S):\n");
			printf("1.Scope changed(C)\n");
			printf("2.Scope unchanged(U)\n");
			scanf("%d",&scope);
				switch(scope)
				{
					case 1:
						scope=1;
					break;
					
					case 2:
						scope=0;
					break;
				}
								system("cls");
float PRNone;
float PRLow;
float PRHigh;
float choose3;

	printf("Choose Privillege Required(PR): \n");
	printf("1.None(N) \n");
	printf("2.Low(L) \n");
	printf("3.High(H) \n");
	scanf("%d",&privillegerequired);
	
switch(privillegerequired)
{
		case 1:
			PRNone=0.85;
			choose3=PRNone;
		break;
		
		case 2:						
					switch(scope)
			{
				case 1:
					scope=1;
					PRLow=0.68;
					choose3=PRLow;
				break;
				
				case 2:
					scope=0;
					PRLow=0.62;
					choose3=PRLow;
				break;
			}
			
		break;
	
		case 3:							
					switch(scope)
			{
				case 1:
				    scope=1;
					PRHigh=0.50;
					choose3=PRHigh;
				break;
				
				case 2:
					scope=0;
					PRHigh=0.27;
					choose3=PRHigh;
				break;	
			}
			
		break;
	
		default:
			printf("Invalid Option:\n");
}
									system("cls");			
int userinteraction;
float UINone;
float UIRequired;
float choose4;

	printf("Choose User Interaction(UI):\n");
	printf("1.None(N)\n");
	printf("2.Required(R)\n");
	scanf("%d",&userinteraction);
	
switch(userinteraction)
{
	case 1:
		UINone=0.85;
		choose4=UINone;
	break;
	
	case 2:
		UIRequired=0.62;
		choose4=UIRequired;
	break;
	
	default:
		printf("Invalid Option \n");
		
}
								system("cls");
int confidentialityimpact;
float CINone;
float CILow;
float CIHigh;
float choose5;

	printf("Choose Confidentiality Impact(C)\n");
	printf("1.None(N)\n");
	printf("2.Low(L)\n");
	printf("3.High(H)\n");
	scanf("%d",&confidentialityimpact);
	
switch(confidentialityimpact)
{
	case 1:
		CINone=0;
		choose5=CINone;
	break;
	
	case 2:
		CILow=0.22;
		choose5=CILow;
	break;
	
	case 3:
		CIHigh=0.56;
		choose5=CIHigh;
	break;
	
	default:
		printf("Invalid Input \n");
		
}
									system("cls");
int integrityimpact;
float IINone;
float IILow;
float IIHigh;
float choose6;

	printf("Choose Integrity Impact(I)\n");
	printf("1.None(N)\n");
	printf("2.Low(L)\n");
	printf("3.High(H)\n");
	scanf("%d",&integrityimpact);
	
switch(integrityimpact)
{
	case 1:
		IINone=0;
		choose6=IINone;
	break;
	
	case 2:
		IILow=0.22;
		choose6=IILow;
	break;
	
	case 3:
		IIHigh=0.56;
		choose6=IIHigh;
	break;
	
	default:
		printf("Invalid Input \n");
		
}
									system("cls");
int availabilityimpact;
float AINone;
float AILow;
float AIHigh;
float choose7;

	printf("Choose Availability Impact(A):\n");
	printf("1.None(N)\n");
	printf("2.Low(L)\n");
	printf("3.High(H)\n");
	scanf("%d",&availabilityimpact);
	
switch(availabilityimpact)
{
	case 1:
		AINone=0;
		choose7=AINone;
	break;
	
	case 2:
		AILow=0.22;
		choose7=AILow;
	break;
	
	case 3:
		AIHigh=0.56;
		choose7=AIHigh;
	break;
	
	default:
		printf("Invalid Input\n");
		
}
								system("cls");
int confidentialityreq;
float CRNotdefined;
float CRHigh;
float CRMedium;
float CRLow;
float choose8;

	printf("Choose Confidentiality Requirement(CR)\n");
	printf("1.Not Defined(ND)\n");
	printf("2.High(H)\n");
	printf("3.Medium(M)\n");
	printf("4.Low(L)\n");
	scanf("%d",&confidentialityreq);
	
switch(confidentialityreq)
{
	case 1:
		CRNotdefined=1;
		choose8=CRNotdefined;
	break;
	
	case 2:
		CRHigh=1.5;
		choose8=CRHigh;
	break;
	
	case 3:
		CRMedium=1;
		choose8=CRMedium;
	break;
	
	case 4:
		CRLow=0.5;
		choose8=CRLow;
	break;
	
	default:
		printf("Invalid Input \n");
		
}
									system("cls");
int integrityreq;
float IRNotdefined;
float IRHigh;
float IRMedium;
float IRLow;
float choose9;

	printf("Choose Integrity Requirement(IR)\n");
	printf("1.Not Defined(ND)\n");
	printf("2.High(H)\n");
	printf("3.Medium(M)\n");
	printf("4.Low(L)\n");
	scanf("%d",&integrityreq);
	
switch(integrityreq)
{
	case 1:
		IRNotdefined=1;
		choose9=IRNotdefined;
	break;
	
	case 2:
		IRHigh=1.5;
		choose9=IRHigh;
	break;
	
	case 3:
		IRMedium=1;
		choose9=IRMedium;
	break;
	
	case 4:
		IRLow=0.5;
		choose9=IRLow;
	break;
	
	default:
		printf("Invalid Input \n");
		
}
									system("cls");

int availabilityreq;
float ARNotdefined;
float ARHigh;
float ARMedium;
float ARLow;
float choose10;

	printf("Choose Availability Requirement(AR)\n");
	printf("1.Not Defined(ND)\n");
	printf("2.High(H)\n");
	printf("3.Medium(M)\n");
	printf("4.Low(L)\n");
	scanf("%d",&availabilityreq);
	
switch(confidentialityreq)
{
	case 1:
		ARNotdefined=1;
		choose10=ARNotdefined;
	break;
	
	case 2:
		ARHigh=1.5;
		choose10=ARHigh;
	break;
	
	case 3:
		ARMedium=1;
		choose10=ARMedium;
	break;
	
	case 4:
		ARLow=0.5;
		choose10=ARLow;
	break;
	
	default:
		printf("Invalid Input \n");
		
}
									system("cls");
									
int Exploitcodematurity;
	float notdefined;
	float high;
	float functional;
	float proofofconcept;
	float unproven;
	float choose11;
	
		printf("Choose Exploit Code Maturity(E):\n");
		printf("1.Not Defined(X)\n");
		printf("2.Unproven(U)\n");
		printf("3.Proof-Of-Concept(P)\n");
		printf("4.Functional(F)\n");
		printf("5.High(H)\n");
		scanf("%d",&Exploitcodematurity);
		
	switch(Exploitcodematurity)
	{
			case 1:
				notdefined=1;
				choose11=notdefined;
			break;
			
			case 2:
				unproven=0.91;
				choose11=unproven;
			break;
			
			case 3:
				proofofconcept=0.94;
				choose11=proofofconcept;
			break;
			
			case 4:
				functional=0.97;
				choose11=functional;
			break;
			
			case 5:
				high=1;
				choose11=high;
			break;
			
			default:
				printf("Invalid Option\n");
			break;	
	}
										system("cls");
int Remediationlevel;
float RLnotdefined;
float RLunavailable;
float RLworkaround;
float RLtemporaryfix;
float RLofficialfix;
float choose12;
	printf("Choose Remediation Level(RL):\n");
		printf("1.Not Defined(X)\n");
		printf("2.Official Fix(O)\n");
		printf("3.TemporaryFix(T)\n");
		printf("4.Workaround(W)\n");
		printf("5.Unavailable(U)\n");
		scanf("%d",&Remediationlevel);
		
	switch(Remediationlevel)
	{
			case 1:
				RLnotdefined=1;
				choose12=RLnotdefined;
			break;
			
			case 2:
				RLofficialfix=0.95;
				choose12=RLofficialfix;
			break;
			
			case 3:
				RLtemporaryfix=0.96;
				choose12=RLtemporaryfix;
			break;
			
			case 4:
				RLworkaround=0.97;
				choose12=RLworkaround;
			break;
			
			case 5:
				RLunavailable=1;
				choose12=RLunavailable;
			break;
			
			default:
				printf("Invalid Option\n");
			break;
		}
											system("cls");
int Reportconfidence;
float RCnotdefined;
float RCunknown;
float RCreasonable;
float RCconfirmed;
float choose13;
	printf("Choose Report Confidence(RC):\n");
		printf("1.Not Defined(X)\n");
		printf("2.Unknown(U)\n");
		printf("3.Reasonable(R)\n");
		printf("4.Confirmed(C)\n");
		scanf("%d",&Reportconfidence);
		
	switch(Reportconfidence)
	{
			case 1:
				RCnotdefined=1;
				choose13=RCnotdefined;
			break;
			
			case 2:
				RCunknown=0.92;
				choose13=RCunknown;
			break;
			
			case 3:
				RCreasonable=0.96;
				choose13=RCreasonable;
			break;
			
			case 4:
				RCconfirmed=1;
				choose13=RCconfirmed;
			break;
						
			default:
				printf("Invalid Option\n");
			break;
		}	
												system("cls");									
																										
	Environment(choose1,choose2,choose3,choose4,choose5,choose6,choose7,scope,choose8,choose9,choose10,choose11,choose12,choose13);//calling
	
	
}

//define

void Environment(float AV,float AC,float PR,float UI,float CI,float II,float AI,int scope,float CR,float IR,float AR,float EC,float RL,float RC){
	
	printf("Numerical values:\n");
	printf("Attack Vector(AV): %f \n",AV);
	printf("Attack Complexity(AC): %f \n",AC);
	printf("Privillege Required(PR): %f\n",PR);
	printf("User Interaction(UI): %f \n",UI);
	printf("Confideniality Impact(CI): %f \n",CI);
	printf("Integrity Impact(II): %f \n",II);
	printf("Availability Impact(AI): %f \n",AI);
	printf("Scope:%d\n",scope);
	printf("Confidentiality Requirement(CR): %f \n",CR);
	printf("Integrity Requirement(IR): %f \n",IR);
	printf("Availability Requirement(AR): %f \n",AR);
	float ISC_Modified;
		ISC_Modified = 1-((1-CI*CR)*(1-AI*AR)*(1-II*IR));
			if(ISC_Modified<=0.915){
				ISC_Modified=ISC_Modified;
		}
			else{
				ISC_Modified=0.915;
			}
			
		printf("ISC_Modified: %f\n",ISC_Modified);
	
	float Exploitability;	
		Exploitability = 8.22*AV*AC*PR*UI;
			printf("Exploitability:%f\n",Exploitability);
			
	float ISC;
	if(scope==1){
		ISC = 7.52*(ISC_Modified-0.029) - 3.25* pow((ISC_Modified-0.02),15) ;
		
	}
	
	else{
		ISC = 6.42*ISC_Modified;
	}
			printf("Value of ISC obtained is:%f\n",ISC);
	
		if(ISC <= 0){
		
 	Environmental_score = 0;
    }
    //end of if
	else{
	
	 	   if(scope == 1)
	 	   {
		   float temp_environmental;
	 	   temp_environmental=1.08*(ISC + Exploitability);
	        	if(temp_environmental<=10) 		
	              { 
		            Environmental_score=temp_environmental;
	                     }
				else{
					temp_environmental=10;
						}
	 		}
	 		
		 if(scope == 0)
	 		{ float temp_environmental;
	 		  temp_environmental=(ISC+Exploitability);
	 		      	if(temp_environmental<=10) 		
	              { 
		            Environmental_score=temp_environmental;
	                     }
				else{
					Environmental_score=10;
						}
                     }
     }//end of else
     
printf("\nEnvironmental score is: %f\n",Environmental_score);
printf("Criticality:");
		if(Environmental_score<=3.9){
			printf("LOW\n");
		}
		else if(3.9<Environmental_score<=6.9){
			printf("MEDIUM\n");
		}
		else if(6.9<Environmental_score<=8.9){
			printf("HIGH\n");
		}
		else if(8.9<Environmental_score<=10){
			printf("CRITICAL\n");
		}     
}